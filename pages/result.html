<!DOCTYPE html>
<html lang="en">
  Â  Â  Â 
  <head>
    Â  Â  Â  Â  Â  Â 
    <meta charset="UTF-8" />
    Â  Â  Â  Â  Â  Â 
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    Â  Â  Â  Â  Â  Â 
    <title>Diagnosis Result - Salone Plant Doctor</title>
    Â  Â  Â  Â  Â  Â 
    <link rel="stylesheet" href="../style.css" />
    Â  Â  Â  Â  Â  Â 
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    Â  Â  Â  Â 
  </head>
  Â  Â  Â 
  <body>
    Â  Â  Â  Â  Â  Â 
    <header>
      Â  Â  Â  Â  Â  Â  Â  Â  Â 
      <div class="logo">
        Â  Â  Â  Â  Â  Â  Â  Â  <a href="../index.html">Back</a> Â  Â  Â  Â  Â  Â  Â  Â 
        <span>Salone Plant Doctor</span> Â  Â  Â  Â  Â  Â 
      </div>
      Â  Â  Â  Â  Â  Â  Â  Â  Â 
      <nav class="main-nav">
        Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
        <ul>
          Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
          <li><a href="../index.html">Home</a></li>
          Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
          <li><a href="#">Services</a></li>
          Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
          <li><a href="shop.html">Shop</a></li>
          Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
        </ul>
        Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
      </nav>
      Â  Â  Â  Â  Â  Â  <button class="auth-btn">Log In / Sign</button> Â  Â  Â  Â 
    </header>

    Â  Â  Â  Â  Â  Â 
    <main class="container diagnosis-page-container">
      Â  Â  Â 
      <div class="diagnosis-feature-box">
        Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
        <h1>Diagnosis Complete</h1>
        Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
        <p class="subtitle">
          Â  Â  Â  Â  Â 
          <strong id="diagnosis-plant-name"
            >Plant identified accurately.</strong
          >
          Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
        </p>

        Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
        <div class="scan-results-grid">
          Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
          <div class="results-sidebar">
            Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-microscope"></i> Â  Â  Â  Â  Â 
            Â  Â  Â  Â  Â  Â  Â 
            <h2>Scan Result</h2>
            Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
          </div>

          Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
          <div class="results-content">
            Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
            <div id="result-photo-display" class="scanned-image-container">
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              <img
                src="../assets/placeholder-cassava-leaf.jpg"
                alt="Scanned Plant Leaf"
              />
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
            </div>

            Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
            <div id="status-header" class="diagnosis-text">
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              <h2 id="diagnosis-health-status">Loading Diagnosis...</h2>
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              <p id="diagnosis-issue">Loading specific issue...</p>
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              <p id="diagnosis-confidence">Loading confidence level...</p>
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
            </div>

            Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
            <div class="diagnosis-detail-section">
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              <h4>Why is this happening? (Cause)</h4>
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              <p id="diagnosis-cause">Loading cause...</p>
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
            </div>

            Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
            <div class="recommendation-box">
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              <h4>ðŸŒ± Farmer Summary (What to Do)</h4>
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              <p id="recommendation-summary">Loading summary...</p>
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
            </div>

            Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
            <div class="action-buttons" style="margin-bottom: 30px">
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              <button id="play-audio-krio-btn" class="secondary-btn">
                Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
                <i class="fas fa-volume-up"></i> Listen in Krio Â  Â  Â  Â  Â  Â  Â  Â 
                Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              </button>
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              <button id="save-result-btn" class="secondary-btn">
                Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-save"></i> Save
                Result Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              </button>
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
            </div>

            Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
            <div id="treatment-plan">
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              <h4>Recommended Treatment Plan</h4>
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              <ol id="treatment-plan-list">
                Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
                <li>Loading treatment steps...</li>
                Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              </ol>
              Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
            </div>

            Â  Â  Â  Â  Â  Â 
            <div class="result-action-buttons">
              <a href="shop.html" class="primary-btn">
                Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-shopping-cart"></i> Go to
                Shop for Supplies Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              </a>

              Â  Â  Â  Â  Â  Â  Â  Â 
              <button
                id="finish-scan-button"
                class="secondary-btn"
                onclick="window.location.href='diagnosis.html';"
              >
                Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-redo"></i> Start New Scan Â 
                Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
              </button>
              Â  Â  Â  Â  Â  Â 
            </div>
            Â  Â  Â  Â  Â 
          </div>
          Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
        </div>
        Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
      </div>
      Â  Â  Â  Â  Â  Â  Â 
    </main>

    Â  Â  Â  Â  Â  Â 
    <footer>
      Â  Â  Â  Â  Â  Â  Â  Â  Â 
      <p>&copy; Salone Plant Doctor | Privacy Policy | Terms of Service</p>
      Â  Â  Â  Â  Â  Â  Â 
    </footer>

    Â  Â  Â  Â  Â  Â 
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // 1. Retrieve data from Local Storage
        const resultDataJson = localStorage.getItem("diagnosisResult");
        const scannedImageURL = localStorage.getItem("scannedImageURL"); // --- DOM Elements to Populate ---

        const resultPhotoDisplay = document.getElementById(
          "result-photo-display"
        ); // The status-header div now uses the 'diagnosis-text' class by default, // and the dynamic status class is added in the styling section (A).
        const statusHeader = document.getElementById("status-header");
        const diagnosisHealthStatus = document.getElementById(
          "diagnosis-health-status"
        );
        const diagnosisPlantName = document.getElementById(
          "diagnosis-plant-name"
        );
        const diagnosisIssue = document.getElementById("diagnosis-issue");
        const diagnosisConfidence = document.getElementById(
          "diagnosis-confidence"
        );
        const diagnosisCause = document.getElementById("diagnosis-cause");
        const recommendationSummary = document.getElementById(
          "recommendation-summary"
        );
        const treatmentPlanList = document.getElementById(
          "treatment-plan-list"
        );

        if (!resultDataJson) {
          console.error(
            "No diagnosis data found in localStorage. Redirecting to input."
          ); // Fallback: If no data, send the user back to diagnosis page
          window.location.href = "diagnosis.html";
          return;
        }

        const data = JSON.parse(resultDataJson); // ---------------------------------------------------- // A. Image Display and Page Styling // ---------------------------------------------------- // Display the image that was scanned

        if (resultPhotoDisplay && scannedImageURL) {
          // Replaces the placeholder image with the scanned image
          resultPhotoDisplay.innerHTML = `<img src="${scannedImageURL}" alt="Scanned Plant Photo">`;
        } // Apply the correct CSS class (status-healthy or status-unhealthy)

        if (statusHeader && data.status_class) {
          // Ensure it keeps the base 'diagnosis-text' class
          statusHeader.className = `diagnosis-text ${data.status_class}`;
        } // ---------------------------------------------------- // B. Diagnosis Summary Hydration // ---------------------------------------------------- // Plant Name (e.g., Plant Identified: Cassava)

        if (diagnosisPlantName) {
          diagnosisPlantName.innerHTML = `Plant Identified: <strong>${
            data.plant_name || "Unknown"
          }</strong>`;
        } // Status Header Content (Health Status and Disease Name)

        if (diagnosisHealthStatus) {
          const statusIcon =
            data.health_status === "Healthy"
              ? '<i class="fas fa-check-circle"></i>'
              : '<i class="fas fa-exclamation-triangle"></i>'; // Use the disease name/status in the main header
          diagnosisHealthStatus.innerHTML = `${statusIcon} Diagnosis: <strong>${
            data.disease || data.health_status
          }</strong>`;
        } // Detailed Diagnosis Fields

        if (diagnosisIssue) {
          // Display Health Status clearly right below the main diagnosis
          diagnosisIssue.innerHTML = `<strong>Health Status:</strong> <span class="${
            data.status_class || ""
          }">${data.health_status || "N/A"}</span>`;
        }
        if (diagnosisConfidence) {
          // Use the confidence name to apply CSS (e.g., confidence-high)
          const confidenceClass = `confidence-${(
            data.confidence || "low"
          ).toLowerCase()}`;
          diagnosisConfidence.innerHTML = `<strong>Confidence:</strong> <span class="${confidenceClass}">${
            data.confidence || "N/A"
          }</span>`;
        }
        if (diagnosisCause) {
          diagnosisCause.innerHTML =
            data.cause || "No specific cause provided.";
        } // Farmer Summary

        if (recommendationSummary) {
          recommendationSummary.textContent =
            data.recommendation_summary || "Please consult an expert.";
        } // ---------------------------------------------------- // C. Treatment Steps // ----------------------------------------------------

        if (treatmentPlanList) {
          treatmentPlanList.innerHTML = ""; // Clear hardcoded steps
          const steps = data.treatment_steps || [];

          if (steps.length === 0) {
            const li = document.createElement("li");
            li.textContent = "No specific actions recommended at this time.";
            treatmentPlanList.appendChild(li);
          } else {
            steps.forEach((step) => {
              const li = document.createElement("li");
              li.textContent = step;
              treatmentPlanList.appendChild(li);
            });
          }
        } // --- Action Button Listeners ---

        const playAudioBtn = document.getElementById("play-audio-krio-btn");
        if (playAudioBtn) {
          playAudioBtn.addEventListener("click", () => {
            alert("Krio Audio Playback feature coming soon!");
          });
        }

        const saveResultBtn = document.getElementById("save-result-btn");
        if (saveResultBtn) {
          saveResultBtn.addEventListener("click", () => {
            alert("Saving feature coming soon!");
          });
        }
      });
    </script>
    Â  Â  Â  Â 
  </body>
</html>
